import{IS_HIDPI}from"./constants.js";import{getRandomNum}from"./utils.js";class BackgroundEl{constructor(canvas,spritePos,containerWidth,type){this.canvas=canvas,this.canvasCtx=this.canvas.getContext("2d"),this.spritePos=spritePos,this.containerWidth=containerWidth,this.xPos=containerWidth,this.yPos=0,this.remove=!1,this.type=type,this.gap=getRandomNum(BackgroundEl.config.MIN_GAP,BackgroundEl.config.MAX_GAP),this.animTimer=0,this.switchFrames=!1,this.spriteConfig={},this.init()}init(){this.spriteConfig=window.Runner.spriteDefinition.BACKGROUND_EL[this.type],this.spriteConfig.FIXED&&(this.xPos=this.spriteConfig.FIXED_X_POS),this.yPos=BackgroundEl.config.Y_POS-this.spriteConfig.HEIGHT+this.spriteConfig.OFFSET,this.draw()}draw(){this.canvasCtx.save();let sourceWidth=this.spriteConfig.WIDTH,sourceHeight=this.spriteConfig.HEIGHT,sourceX=this.spriteConfig.X_POS;var outputWidth=sourceWidth,outputHeight=sourceHeight;IS_HIDPI&&(sourceWidth*=2,sourceHeight*=2,sourceX*=2),this.canvasCtx.drawImage(window.Runner.imageSprite,sourceX,this.spritePos.y,sourceWidth,sourceHeight,this.xPos,this.yPos,outputWidth,outputHeight),this.canvasCtx.restore()}update(speed){this.remove||(this.spriteConfig.FIXED?(this.animTimer+=speed,this.animTimer>BackgroundEl.config.MS_PER_FRAME&&(this.animTimer=0,this.switchFrames=!this.switchFrames),this.spriteConfig.FIXED_Y_POS_1&&this.spriteConfig.FIXED_Y_POS_2&&(this.yPos=this.switchFrames?this.spriteConfig.FIXED_Y_POS_1:this.spriteConfig.FIXED_Y_POS_2)):this.xPos-=BackgroundEl.config.SPEED,this.draw(),this.isVisible())||(this.remove=!0)}isVisible(){return 0<this.xPos+this.spriteConfig.WIDTH}}BackgroundEl.config={MAX_BG_ELS:0,MAX_GAP:0,MIN_GAP:0,POS:0,SPEED:0,Y_POS:0,MS_PER_FRAME:0};export{BackgroundEl};